<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="992px" preserveAspectRatio="none" style="width:944px;height:992px;background:#FEFEFE;" version="1.1" viewBox="0 0 944 992" width="944px" zoomAndPan="magnify"><title>VocalBridge Ops - Simplified System Architecture</title><defs/><g><rect fill="#FEFEFE" height="992" style="stroke:none;stroke-width:1;" width="944" x="0" y="0"/><g class="title" data-source-line="6"><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="610.4785" x="162.3323" y="37.1182">VocalBridge Ops - Simplified System Architecture</text></g><!--cluster API Gateway--><g class="cluster" data-entity="API Gateway" data-source-line="14" data-uid="ent0003" id="cluster_API Gateway"><path d="M446.2029,236.3173 L527.4363,236.3173 A3.75,3.75 0 0 1 529.9363,238.8173 L536.9363,255.686 L842.2029,255.686 A2.5,2.5 0 0 1 844.7029,258.186 L844.7029,341.1873 A2.5,2.5 0 0 1 842.2029,343.6873 L446.2029,343.6873 A2.5,2.5 0 0 1 443.7029,341.1873 L443.7029,238.8173 A2.5,2.5 0 0 1 446.2029,236.3173" fill="#E3F2FD" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="443.7029" x2="536.9363" y1="255.686" y2="255.686"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80.2334" x="447.7029" y="249.3764">API Gateway</text></g><!--cluster Core Services--><g class="cluster" data-entity="Core Services" data-source-line="19" data-uid="ent0006" id="cluster_Core Services"><path d="M202.2029,390.6873 L287.0457,390.6873 A3.75,3.75 0 0 1 289.5457,393.1873 L296.5457,410.056 L758.2029,410.056 A2.5,2.5 0 0 1 760.7029,412.556 L760.7029,495.5573 A2.5,2.5 0 0 1 758.2029,498.0573 L202.2029,498.0573 A2.5,2.5 0 0 1 199.7029,495.5573 L199.7029,393.1873 A2.5,2.5 0 0 1 202.2029,390.6873" fill="#E8F5E9" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="199.7029" x2="296.5457" y1="410.056" y2="410.056"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="83.8428" x="203.7029" y="403.7464">Core Services</text></g><!--cluster AI Provider Layer--><g class="cluster" data-entity="AI Provider Layer" data-source-line="25" data-uid="ent0010" id="cluster_AI Provider Layer"><path d="M16.2029,558.0573 L126.0105,558.0573 A3.75,3.75 0 0 1 128.5105,560.5573 L135.5105,577.426 L421.2029,577.426 A2.5,2.5 0 0 1 423.7029,579.926 L423.7029,669.6573 A2.5,2.5 0 0 1 421.2029,672.1573 L16.2029,672.1573 A2.5,2.5 0 0 1 13.7029,669.6573 L13.7029,560.5573 A2.5,2.5 0 0 1 16.2029,558.0573" fill="#F3E5F5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="13.7029" x2="135.5105" y1="577.426" y2="577.426"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="108.8076" x="17.7029" y="571.1164">AI Provider Layer</text></g><!--cluster AI Providers--><g class="cluster" data-entity="AI Providers" data-source-line="34" data-uid="ent0015" id="cluster_AI Providers"><path d="M38.9663,753.1693 C44.3983,746.2889 51.6822,745.7006 56.3421,754.0502 C60.8464,742.3156 69.35,740.9871 76.8486,751.2601 C82.9326,743.3419 90.9913,745.1392 95.3514,753.2502 C100.5595,745.9031 105.8296,745.916 111.2016,753.071 C115.7595,743.8316 121.4914,741.4328 129.3801,749.5905 C134.162,741.6933 143.8035,740.1567 148.6923,749.4705 C156.5341,740.6765 163.1799,741.0623 169.0543,751.5483 C173.7035,741.7594 179.8483,743.3527 186.0592,749.9252 C191.1718,742.6788 199.3412,743.1224 202.2941,752.088 C208.5949,742.5124 214.7283,742.2982 222.144,750.8683 C228.9356,743.2936 234.2966,744.8478 238.9106,753.1656 C244.6481,743.0749 253.0536,744.3997 259.0546,752.8798 C264.9198,742.596 272.2802,743.6591 277.9567,753.0609 C287.5091,745.3261 295.9806,747.8079 300.7029,758.8973 C302.4924,759.8429 302.5355,761.4295 300.7823,762.4541 C309.6097,764.7574 311.9891,770.9817 306.0973,778.2406 C315.0441,782.4952 317.7963,791.8722 308.1241,798.0333 C318.1822,806.1483 317.9423,815.1221 305.3222,820.3956 C311.6138,831.375 308.3736,842.9372 293.7029,843.2673 C295.892,843.5972 296.1772,844.6189 295.0864,846.3981 C290.0727,853.9386 283.7706,853.1705 278.9609,846.1718 C272.986,855.9525 266.252,854.8581 260.3062,846.1425 C254.4408,855.5096 244.1649,855.2519 239.3116,845.0562 C235.2066,852.6493 226.5147,854.5116 221.5207,846.0409 C215.9771,853.1389 209.082,853.4169 203.6777,845.8711 C197.0476,853.3793 191.3866,855.2071 185.5853,845.0235 C181.4306,852.7513 175.4057,855.0586 168.8353,847.7069 C160.8981,855.3699 153.5512,855.288 147.6814,845.2378 C143.9389,852.9686 137.0248,853.9174 132.3075,846.2083 C125.1105,856.8837 116.6584,855.6743 110.947,844.7398 C106.0058,852.2391 98.7987,852.759 94.0839,844.4977 C88.3819,853.5728 80.9243,854.0081 74.6032,845.171 C68.0716,853.5767 62.1627,851.849 56.7381,843.9576 C44.7485,854.8524 35.1819,850.7993 30.7029,836.2673 C33.2352,835.725 34.5905,836.7593 34.1701,839.4419 C22.1039,835.8607 19.2611,830.0153 27.8338,819.7823 C13.7291,816.8681 11.6556,809.4973 19.3239,798.0553 C11,787.8701 13.6931,780.9115 26.5198,778.5156 C18.5006,766.4799 21.0956,753.5866 37.7029,751.8973 C38.6634,751.7264 39.2321,752.1222 38.9663,753.1693" fill="#FFEBEE" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.2847" x="127.0606" y="767.9564">AI Providers</text></g><!--entity API--><g class="entity" data-entity="API" data-source-line="15" data-uid="ent0004" id="entity_API"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.7798" x="459.3129" y="284.3173"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="556.0927" y="289.3173"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="554.0927" y="291.3173"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="554.0927" y="295.3173"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="76.7798" x="474.3129" y="315.3764">Fastify Server</text></g><!--entity Auth--><g class="entity" data-entity="Auth" data-source-line="16" data-uid="ent0005" id="entity_Auth"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.0659" x="696.6729" y="284.3173"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="808.7388" y="289.3173"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="806.7388" y="291.3173"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="806.7388" y="295.3173"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="92.0659" x="711.6729" y="315.3764">Auth Middleware</text></g><!--entity MessageSvc--><g class="entity" data-entity="MessageSvc" data-source-line="20" data-uid="ent0007" id="entity_MessageSvc"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="131.7437" x="215.8329" y="438.6873"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="327.5766" y="443.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="325.5766" y="445.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="325.5766" y="449.6873"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="91.7437" x="230.8329" y="469.7464">Message Service</text></g><!--entity AgentSvc--><g class="entity" data-entity="AgentSvc" data-source-line="21" data-uid="ent0008" id="entity_AgentSvc"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.667" x="475.3729" y="438.6873"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="572.0399" y="443.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="570.0399" y="445.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="570.0399" y="449.6873"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="76.667" x="490.3729" y="469.7464">Agent Service</text></g><!--entity BillingSvc--><g class="entity" data-entity="BillingSvc" data-source-line="22" data-uid="ent0009" id="entity_BillingSvc"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="117.8755" x="626.7629" y="438.6873"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="724.6384" y="443.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="722.6384" y="445.6873"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="722.6384" y="449.6873"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="77.8755" x="641.7629" y="469.7464">Billing Service</text></g><!--entity Orchestrator--><g class="entity" data-entity="Orchestrator" data-source-line="26" data-uid="ent0011" id="entity_Orchestrator"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="159.1685" x="30.1229" y="609.4273"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="169.2914" y="614.4273"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="167.2914" y="616.4273"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="167.2914" y="620.4273"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="119.1685" x="45.1229" y="640.4864">Provider Orchestrator</text></g><g class="entity" data-entity="GMN12" data-source-line="28" data-uid="ent0013" id="entity_GMN12"><path d="M223.9429,606.0573 L223.9429,627.1073 L189.7729,631.1073 L223.9429,635.1073 L223.9429,656.1633 A0,0 0 0 0 223.9429,656.1633 L407.4561,656.1633 A0,0 0 0 0 407.4561,656.1633 L407.4561,616.0573 L397.4561,606.0573 L223.9429,606.0573 A0,0 0 0 0 223.9429,606.0573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M397.4561,606.0573 L397.4561,616.0573 L407.4561,616.0573 L397.4561,606.0573" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="113.7705" x="229.9429" y="622.1164">&#8226; Retry (3 attempts)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="162.5132" x="229.9429" y="635.485">&#8226; Fallback to backup provider</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="105.9878" x="229.9429" y="648.8537">&#8226; Timeout handling</text></g><!--entity VendorA--><g class="entity" data-entity="VendorA" data-source-line="35" data-uid="ent0016" id="entity_VendorA"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="109.4268" x="182.9929" y="791.8973"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="272.4197" y="796.8973"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="270.4197" y="798.8973"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="270.4197" y="802.8973"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="69.4268" x="197.9929" y="822.9564">VendorA API</text></g><!--entity VendorB--><g class="entity" data-entity="VendorB" data-source-line="36" data-uid="ent0017" id="entity_VendorB"><rect fill="#FFFFFF" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="109.4482" x="38.9829" y="791.8973"/><rect fill="#FFFFFF" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="128.4311" y="796.8973"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="126.4311" y="798.8973"/><rect fill="#FFFFFF" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="126.4311" y="802.8973"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="69.4482" x="53.9829" y="822.9564">VendorB API</text></g><!--entity Client--><g class="entity" data-entity="Client" data-source-line="12" data-uid="ent0002" id="entity_Client"><ellipse cx="517.7059" cy="82.3473" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M517.7059,90.3473 L517.7059,117.3473 M504.7059,98.3473 L530.7059,98.3473 M517.7059,117.3473 L504.7059,132.3473 M517.7059,117.3473 L530.7059,132.3473" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="31.5659" x="501.9229" y="145.4064">Client</text></g><!--entity DB--><g class="entity" data-entity="DB" data-source-line="39" data-uid="ent0018" id="entity_DB"><path d="M613.8129,619.9273 C613.8129,609.9273 655.7011,609.9273 655.7011,609.9273 C655.7011,609.9273 697.5893,609.9273 697.5893,619.9273 L697.5893,642.296 C697.5893,652.296 655.7011,652.296 655.7011,652.296 C655.7011,652.296 613.8129,652.296 613.8129,642.296 L613.8129,619.9273" fill="#ECEFF1" style="stroke:#000000;stroke-width:1;"/><path d="M613.8129,619.9273 C613.8129,629.9273 655.7011,629.9273 655.7011,629.9273 C655.7011,629.9273 697.5893,629.9273 697.5893,619.9273" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="63.7764" x="623.8129" y="644.9864">PostgreSQL</text></g><!--entity Worker--><g class="entity" data-entity="Worker" data-source-line="41" data-uid="ent0019" id="entity_Worker"><rect fill="#FFF9C4" height="43.3687" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.4014" x="493.5029" y="791.8973"/><rect fill="#FFF9C4" height="10" style="stroke:#000000;stroke-width:1;" width="15" x="575.9043" y="796.8973"/><rect fill="#FFF9C4" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="573.9043" y="798.8973"/><rect fill="#FFF9C4" height="2" style="stroke:#000000;stroke-width:1;" width="4" x="573.9043" y="802.8973"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="62.4014" x="508.5029" y="822.9564">Job Worker</text></g><g class="entity" data-entity="GMN39" data-source-line="75" data-uid="ent0040" id="entity_GMN39"><path d="M732.2529,579.3173 L732.2529,627.1073 L698.0029,631.1073 L732.2529,635.1073 L732.2529,682.8979 A0,0 0 0 0 732.2529,682.8979 L937.143,682.8979 A0,0 0 0 0 937.143,682.8979 L937.143,589.3173 L927.143,579.3173 L732.2529,579.3173 A0,0 0 0 0 732.2529,579.3173" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M927.143,579.3173 L927.143,589.3173 L937.143,589.3173 L927.143,579.3173" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106.02" x="738.2529" y="595.3764">Database Tables:</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="183.8901" x="738.2529" y="608.745">&#8226; tenants (multi-tenant isolation)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="109.8872" x="738.2529" y="622.1137">&#8226; agents (AI config)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="146.04" x="738.2529" y="635.4823">&#8226; sessions (conversations)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="176.1074" x="738.2529" y="648.851">&#8226; messages (with idempotency)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="145.3848" x="738.2529" y="662.2196">&#8226; provider_calls (tracking)</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="132.8057" x="738.2529" y="675.5883">&#8226; usage_events (billing)</text></g><g class="entity" data-entity="GMN42" data-source-line="85" data-uid="ent0043" id="entity_GMN42"><path d="M312.5229,58.7373 L312.5229,162.3179 A0,0 0 0 0 312.5229,162.3179 L466.8764,162.3179 A0,0 0 0 0 466.8764,162.3179 L466.8764,114.5273 L501.5229,110.5273 L466.8764,106.5273 L466.8764,68.7373 L456.8764,58.7373 L312.5229,58.7373 A0,0 0 0 0 312.5229,58.7373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M456.8764,58.7373 L456.8764,68.7373 L466.8764,68.7373 L456.8764,58.7373" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.7046" x="318.5229" y="74.7964">Request Flow:</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="128.2134" x="318.5229" y="88.165">1. Client sends API key</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="133.3535" x="318.5229" y="101.5337">2. Auth validates tenant</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="121.4028" x="318.5229" y="114.9023">3. Message processed</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="112.3794" x="318.5229" y="128.271">4. AI provider called</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="93.8062" x="318.5229" y="141.6396">5. Usage tracked</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="119.0396" x="318.5229" y="155.0083">6. Response returned</text></g><!--link Client to API--><g class="link" data-entity-1="Client" data-entity-2="API" data-source-line="47" data-uid="lnk20" id="link_Client_API"><path d="M501.5629,139.0073 C496.5329,146.8173 490.7129,155.1373 484.7029,162.3173 C472.1929,177.2673 460.4529,174.4273 452.7029,192.3173 C447.7529,203.7373 448.7029,208.5373 452.7029,220.3173 C461.1029,245.0673 475.8102,263.9162 491.0602,279.7462" fill="none" id="Client-to-API" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="495.2229,284.0673,491.8595,274.8105,491.7539,280.4664,486.0981,280.3609,495.2229,284.0673" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="82.1455" x="453.7029" y="204.3764">1. API Request</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="66.9829" x="461.2842" y="217.745">(X-API-Key)</text></g><!--reverse link Client to API--><g class="link" data-entity-1="Client" data-entity-2="API" data-source-line="65" data-uid="lnk34" id="link_Client_API"><path d="M532.1624,153.8096 C536.3124,167.5096 538.6429,177.5873 540.7029,192.3173 C545.2029,224.5473 534.6429,261.4173 526.3829,283.9573" fill="none" id="Client-backto-API" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="530.4229,148.0673,529.2039,157.8404,531.8725,152.8526,536.8603,155.5211,530.4229,148.0673" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="67.5684" x="542.7729" y="210.8764">7. Response</text></g><!--link API to Auth--><g class="link" data-entity-1="API" data-entity-2="Auth" data-source-line="49" data-uid="lnk21" id="link_API_Auth"><path d="M576.3829,306.0073 C612.4829,306.0073 652.8429,306.0073 690.2829,306.0073" fill="none" id="API-to-Auth" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="696.2829,306.0073,687.2829,302.0073,691.2829,306.0073,687.2829,310.0073,696.2829,306.0073" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="84.729" x="594.3829" y="300.0664">2. Authenticate</text></g><!--link Auth to DB--><g class="link" data-entity-1="Auth" data-entity-2="DB" data-source-line="50" data-uid="lnk22" id="link_Auth_DB"><path d="M769.8829,328.0073 C784.2229,374.2773 810.2529,485.3573 751.7029,542.0573 C739.6129,553.7573 728.8329,540.9173 714.7029,550.0573 C692.0929,564.6873 677.945,585.9171 668.135,604.4071" fill="none" id="Auth-to-DB" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="665.3229,609.7073,673.0745,603.6317,667.6663,605.2905,666.0075,599.8823,665.3229,609.7073" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="79.417" x="789.2029" y="464.9264">Lookup tenant</text></g><!--link API to MessageSvc--><g class="link" data-entity-1="API" data-entity-2="MessageSvc" data-source-line="52" data-uid="lnk23" id="link_API_MessageSvc"><path d="M510.1029,327.8773 C503.7529,342.7373 493.3529,362.1873 478.7029,374.6873 C471.1029,381.1673 466.9529,378.9173 457.7029,382.6873 C413.5729,400.6973 369.3122,420.0624 333.9922,435.8224" fill="none" id="API-to-MessageSvc" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="328.5129,438.2673,338.3617,438.2528,333.079,436.2299,335.1019,430.9471,328.5129,438.2673" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="107.7764" x="492.6329" y="371.7464">3. Process Message</text></g><!--reverse link API to MessageSvc--><g class="link" data-entity-1="API" data-entity-2="MessageSvc" data-source-line="64" data-uid="lnk32" id="link_API_MessageSvc"><path d="M452.8939,312.3569 C389.8339,318.7969 301.7629,332.2173 279.7029,359.6873 C261.9329,381.8273 267.7529,416.5073 274.2229,438.5773" fill="none" id="API-backto-MessageSvc" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="458.8629,311.7473,449.5031,308.6824,453.8888,312.2553,450.3159,316.641,458.8629,311.7473" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="105.6333" x="280.7029" y="371.7464">6. Return response</text></g><!--link MessageSvc to AgentSvc--><g class="link" data-entity-1="MessageSvc" data-entity-2="AgentSvc" data-source-line="53" data-uid="lnk24" id="link_MessageSvc_AgentSvc"><path d="M347.9129,460.3673 C387.4329,460.3673 431.1629,460.3673 469.2329,460.3673" fill="none" id="MessageSvc-to-AgentSvc" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="475.2329,460.3673,466.2329,456.3673,470.2329,460.3673,466.2329,464.3673,475.2329,460.3673" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="91.5664" x="365.9729" y="454.4264">Get agent config</text></g><!--link MessageSvc to DB--><g class="link" data-entity-1="MessageSvc" data-entity-2="DB" data-source-line="54" data-uid="lnk25" id="link_MessageSvc_DB"><path d="M347.9729,478.9673 C380.8729,487.5073 421.2929,497.7073 457.7029,506.0573 C474.9529,510.0073 480.2429,507.5773 496.7029,514.0573 C525.2829,525.3073 530.5529,532.4173 555.7029,550.0573 C582.6529,568.9473 607.2739,588.8919 627.1239,605.6119" fill="none" id="MessageSvc-to-DB" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="631.7129,609.4773,627.4063,600.6199,627.8887,606.2562,622.2525,606.7386,631.7129,609.4773" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="108.0449" x="544.8029" y="526.1164">Check idempotency</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="71.2261" x="563.2123" y="539.485">Load context</text></g><!--link MessageSvc to Orchestrator--><g class="link" data-entity-1="MessageSvc" data-entity-2="Orchestrator" data-source-line="56" data-uid="lnk26" id="link_MessageSvc_Orchestrator"><path d="M260.2629,482.3973 C227.2129,514.8273 168.4655,572.455 135.4255,604.875" fill="none" id="MessageSvc-to-Orchestrator" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="131.1429,609.0773,140.3684,605.629,134.7118,605.5754,134.7653,599.9188,131.1429,609.0773" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="73.6431" x="227.0729" y="532.6164">4. Send to AI</text></g><!--link Orchestrator to VendorA--><g class="link" data-entity-1="Orchestrator" data-entity-2="VendorA" data-source-line="58" data-uid="lnk27" id="link_Orchestrator_VendorA"><path d="M138.1929,653.2073 C156.8229,668.1873 180.6129,689.6973 196.7029,712.8973 C213.7629,737.5073 223.7686,764.5464 230.1886,785.6764" fill="none" id="Orchestrator-to-VendorA" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="231.9329,791.4173,233.1437,781.6432,230.4793,786.6333,225.4893,783.9689,231.9329,791.4173" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="92.5762" x="206.9429" y="724.9564">Primary provider</text></g><!--link Orchestrator to VendorB--><g class="link" data-entity-1="Orchestrator" data-entity-2="VendorB" data-source-line="59" data-uid="lnk28" id="link_Orchestrator_VendorB"><path d="M105.5229,653.2773 C102.5129,669.5173 98.6429,692.5373 96.7029,712.8973 C94.1329,739.9573 93.5948,765.3173 93.5548,785.5273" fill="none" id="Orchestrator-to-VendorB" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="93.5429,791.5273,97.5607,782.5352,93.5528,786.5273,89.5607,782.5194,93.5429,791.5273" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="94.3862" x="97.7029" y="724.9564">Fallback provider</text></g><!--link MessageSvc to BillingSvc--><g class="link" data-entity-1="MessageSvc" data-entity-2="BillingSvc" data-source-line="61" data-uid="lnk29" id="link_MessageSvc_BillingSvc"><path d="M303.4929,438.5373 C324.6229,419.0573 358.6129,391.8973 394.2029,380.5473 C417.6529,373.0773 589.9629,374.1973 609.7029,382.6873 C636.2229,394.0973 654.7003,414.7386 668.0803,433.4286" fill="none" id="MessageSvc-to-BillingSvc" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="671.5729,438.3073,669.5864,428.6609,668.6624,434.2417,663.0815,433.3177,671.5729,438.3073" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="81.7534" x="395.2029" y="371.7464">5. Track usage</text></g><!--link BillingSvc to DB--><g class="link" data-entity-1="BillingSvc" data-entity-2="DB" data-source-line="62" data-uid="lnk30" id="link_BillingSvc_DB"><path d="M681.9629,482.3973 C676.1729,514.9973 666.1333,571.42 660.3933,603.7" fill="none" id="BillingSvc-to-DB" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="659.3429,609.6073,664.8568,601.4466,660.2183,604.6845,656.9803,600.046,659.3429,609.6073" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="66.3867" x="677.0029" y="532.6164">Store billing</text></g><!--reverse link DB to Worker--><g class="link" data-entity-1="DB" data-entity-2="Worker" data-source-line="67" data-uid="lnk36" id="link_DB_Worker"><path d="M640.0403,657.5685 C618.8403,692.0485 579.2029,756.4873 557.6929,791.4673" fill="none" id="DB-backto-Worker" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="643.1829,652.4573,635.0616,658.029,640.5641,656.7166,641.8764,662.2191,643.1829,652.4573" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="81.6675" x="604.5329" y="724.9564">Poll async jobs</text></g><!--reverse link MessageSvc to Worker--><g class="link" data-entity-1="MessageSvc" data-entity-2="Worker" data-source-line="68" data-uid="lnk38" id="link_MessageSvc_Worker"><path d="M335.1895,485.2205 C365.3295,500.4305 397.8629,520.7173 423.7029,550.0573 C490.2229,625.5573 526.7629,743.8273 539.4829,791.5573" fill="none" id="MessageSvc-backto-Worker" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="329.8329,482.5173,336.0656,490.1431,334.2967,484.7699,339.6699,483.001,329.8329,482.5173" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="68.6641" x="502.3729" y="635.6664">Process jobs</text></g><g class="legend" data-source-line="94"><rect fill="none" height="112.0879" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1;" width="380.4424" x="277.3503" y="867.8837"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="108.2881" x="282.3503" y="886.9589">Key Features:</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="268.7031" x="282.3503" y="903.9736">&#9989; Multi-tenant (isolated by tenantId)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="299.2324" x="282.3503" y="920.9882">&#9989; Idempotency (no duplicate processing)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="370.4424" x="282.3503" y="938.0029">&#9989; Retry &amp; Fallback (3 attempts &#8594; backup provider)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="273.666" x="282.3503" y="955.0175">&#9989; Atomic Billing (no double-charging)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="276.626" x="282.3503" y="972.0322">&#9989; Session Locking (concurrent safety)</text></g><!--SRC=[jLRDZjis4BxhAQPQeBKNi87DPjDcWHQmlLBWndzTEsaB10XeQMopIuigINch1W5wQH-WvvxwQ7cI3ad9bjr5J-xwi1Bd6yvmvlk6-iniS8kG2yQpG3_mB6UARM79aeUraaMM3gIG2YxYoFuQY1HNh10cbfcPyryHhgw2m70Z4DxAX8c-ukaQOPfhwC2SRtF1LnnJc9VQu1PwAjbmWuaf50R15_3r6Vzekt5lE871T3oRJgB9Odxk005B31Kb70YEcGc1QV2FGP1JuHWTFEpDXl2A6NnaPGWNqNNyBBw33m508hUvp0WCOSoquQiIvgXsgDm-v7QCwHLc0sEUfeAsKkX1j1PyR0GRI8Lk5vwWjk6-Yc-YbwVXngYrXLT0jrMrDjyb9s7NzbyJwLR-XUjp8NYsFa9MQnRRJB8tX9cIEvwYWX4hxO4lukle9huvJNGFcn9DK1l5gDnkw-O2-MJI82Y-tXYGgrCZmAVV_ePxDAg4rZKmGyJBZMxlJJ4JmX8TZ7I4BtB8gyXxp89lKHO6DYnBxQ78W5dg0jl39K8MwT7HRFdZEEf7qUcftfAZL3tROdUMwlqfKFy4rBUnKcROaccgv4ngirOu_sxaC7TzwlWWYcEIO6EhR-KIlfVgeMAMVxJ9nIy7p_y7qGscaqaqM0oda_CBpiiBEgbyp3hVsEh0BOHNNVTqZpyNrFTtMUk73hrtNcFP3eF0cZgE7DR3oeXSddNT8st64r9d63X3lIzLaZ0ZAIqN36QCr5rjL24EUh78wwxjEsbkBwGmQ20EqIljM9zNQ80vTIKoM_7riSTH8eCD4Zk9LTHJoYOftsKZoLBhQF0NczeJhaqLs4sUTqcSH5aYUMz8BaVssgdcvgqL7zyoaamjXV2_F5oQUnqTN9wimc4kMA-RBYoKzIfytHhMuohCZPrkIsy-sRh83snuqRLYBrG62ZM9GDlksjOvKCKWmdrfSJKWg6JXGJxWJ0f1YYcp17wIInqUOuuPKBVV0yylgjVHZn17lSMR- -ZygZeUdtTz6aMNbtVrc5cmfK1zUtaP-57ezQ2XjQLxdtVyAt0j1JDSPkqAvhXDA9g9dk2rGLET24ScMgVxJZitNPktlgvaVkGaoGRhQqHDh_VqVI48PonzY1ErtH7fFUvy_8emxM0_h_rv1QxSSQiRsnwv6Y0G2_depqkJfIAC9dTtBSC3bcIf1WZicE0qaIbVNmWoqJIehzZSqm9JMYO1KYtgvC4cxzP906ySs9t3BRquK9D8RBbCouVy1Qxjor8Q8xSkSnfr42Epdr5rf_xw7SRD1hLyX-ZRQrbMkGxJTeKS7geChKn2Mj27cXsCzGdgyXBMtwIV7wxDngKAd_xuy_GEhVrwb2nFQlNxCB8WRdMI3LFhHeIvPmYCfEkh8qfIAENwm5PeIjzDNuVW7m00]--></g></svg>